import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.util.HashMap;
import java.util.Iterator;
import java.util.logging.Logger;

import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class UEGeneration {

    private static final Logger LOGGER = Logger.getLogger(UEGeneration.class.getName());

    private static final String FILE_NAME = "UE.xlsx";

    private static final String FILE_PATH = "C:\\Users\\amanjuna\\Desktop\\EquationUE\\";

    public static void main(String[] args) {
        LOGGER.info("Started");
        try {

            HashMap<String, String> hashMap = new HashMap<>();
            FileInputStream excelFile = new FileInputStream(new File(FILE_NAME_PATH));
            Workbook workbook = new XSSFWorkbook(excelFile);
            Sheet emiCorrectionSheet = workbook.getSheet(EMI_CORRECTION);
            Iterator<Row> emiCorrectionSheetIterator = emiCorrectionSheet.iterator();
            int counter = 0;

            LOGGER.info("Gathering Information Started");
            while (emiCorrectionSheetIterator.hasNext()) {
                Row currentRow = emiCorrectionSheetIterator.next();
                if (counter > 0) {
                    int from = (int) currentRow.getCell(2).getNumericCellValue();
                    int to = (int) currentRow.getCell(3).getNumericCellValue();
                    String targetCellName = currentRow.getCell(5).getStringCellValue();
                    String targerCellIndex = targetCellName.substring(0, 1);
                    int targetCellNumber = Integer.parseInt(targetCellName.substring(1));
                    int startFrom = targetCellNumber;
                    for (int i = from; i <= to; i++) {
                        addToMap(hashMap, targerCellIndex + startFrom, CELL_REFERENCE + i);
                        startFrom++;
                    }
                }
                counter++;
            }
            LOGGER.info("Gathering Information Completed");
            updateCell(hashMap);
            // printMap(hashMap);
            excelFile.close();
            LOGGER.info("Completed");
        } catch (FileNotFoundException e) {
            LOGGER.severe(e.getLocalizedMessage());
            // e.printStackTrace();
        } catch (IOException e) {
            LOGGER.severe(e.getLocalizedMessage());
            // e.printStackTrace();
        }
    }

}
